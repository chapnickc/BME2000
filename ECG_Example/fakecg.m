function ecg = fakecg%   function: fakecg%	fakecg generates a 256-point fake ECG with assumed sample spacing %	T=0.002 seconds or a sampling rate of 500 per second.%	One complete cycle is 256 samples.% %	To call from Matlab, we can use%		d = fakecg;%	where d will be returned as a row vector with 256 elements.%%	To generate four repeated cycles, the following statement may be used:%		d = [fakecg fakecg fakecg fakecg];%%	Simulated ECG: cosine P-wave, piecewise-linear QRS & Gaussian T-wave.%%	Based on the Fortran program written by C.W. Thomas and%	Mark S. Rzeszotarsk on Feb. 20, 1981.%%	Written by Datong Wei in Matlab language on Feb. 9, 1991.p = 0.15;q = 0.2;r = 1.;s = 0.2;t = 0.25;alfa = 0.002;%%N1 = 50;N2 = 73;N3 = 78;N4 = 82;N5 = 90;N6 = 98;N7 = 102;N8 = 107;N9 = 175;% p - wavepw = (1.-cos(([1:N1]-1)*2*pi/N1))*p/2.;% p-q segmentpqw = ([N1+1:N2]*0.);% q-waveqw = [-q*([N2+1:N3]-N2)/(N3-N2) -q+q*([N3+1:N4]-N3)/(N4-N3)];% r-waverw = [r*([N4+1:N5]-N4)/(N5-N4) r-r*([N5+1:N6]-N5)/(N6-N5)];% s-wavesw = [-s*([N6+1:N7]-N6)/(N7-N6) -s+s*([N7+1:N8]-N7)/(N8-N7)];% t-wavetw = t*exp(-alfa*([N8+1:256]-N9).^2);% whole ECG dataecg = [pw pqw qw rw sw tw];end